<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ramen Timer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            touch-action: manipulation;
        }
        .ramen-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .ramen-card:hover {
            transform: translateY(-5px);
        }
        .ramen-card.selected {
            transform: scale(1.05);
            box-shadow: 0 0 0 4px #fbbf24;
            border-color: #fbbf24;
        }
        .topping-checkbox:checked + label, .egg-radio:checked + label {
            transform: scale(1.05);
        }
        .topping-checkbox:checked + label { background-color: #f59e0b; color: white; border-color: #f59e0b; }
        .egg-radio:checked + label { background-color: #ea580c; color: white; border-color: #ea580c; }
        .timer-display { font-size: clamp(4rem, 20vw, 8rem); line-height: 1; }
        
        @keyframes pulse-attention {
          0%, 100% { transform: scale(1.05); box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
          50% { transform: scale(1.08); box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
        }
        .pulse-attention {
          animation: pulse-attention 1.5s ease-out;
        }
    </style>
</head>
<body class="bg-zinc-900 text-white antialiased">
    <div class="container mx-auto p-4 max-w-7xl">
        <header class="text-center my-6">
            <div class="flex justify-center mb-4">
                <select id="language-selector" class="bg-zinc-700 text-white rounded-lg p-2 appearance-none cursor-pointer">
                    <option value="ko">í•œêµ­ì–´</option>
                    <option value="en">English</option>
                    <option value="ja">æ—¥æœ¬èª</option>
                    <option value="zh">ä¸­æ–‡</option>
                    <option value="es">EspaÃ±ol</option>
                    <option value="de">Deutsch</option>
                    <option value="vi">Tiáº¿ng Viá»‡t</option>
                </select>
            </div>
            <h1 id="app-title" class="text-4xl font-bold text-amber-400">ğŸœ ë¼ë©´ íƒ€ì´ë¨¸</h1>
            <p id="app-subtitle" class="text-zinc-400 mt-2">ë‹¨ê³„ë³„ë¡œ ë”°ë¼í•˜ëŠ” ì™„ë²½í•œ ë¼ë©´ ì¡°ë¦¬ë²•</p>
        </header>

        <main class="lg:flex lg:gap-8">
            <!-- Left Column: Selections -->
            <div class="lg:w-1/2 space-y-8">
                <section id="ramen-selection" class="bg-zinc-800 p-6 rounded-2xl shadow-lg">
                    <h2 id="ramen-select-title" class="text-2xl font-bold mb-4 border-b-2 border-zinc-700 pb-2">1. ì¡°ë¦¬í•  ë¼ë©´ì„ ì„ íƒí•˜ì„¸ìš”</h2>
                    <div id="ramen-list" class="grid grid-cols-2 sm:grid-cols-3 gap-4"></div>
                </section>

                <section id="topping-selection" class="bg-zinc-800 p-6 rounded-2xl shadow-lg hidden">
                    <h2 id="topping-select-title" class="text-2xl font-bold mb-4 border-b-2 border-zinc-700 pb-2">2. ì¶”ê°€í•  í† í•‘ì„ ì„ íƒí•˜ì„¸ìš”</h2>
                    <div id="toppings" class="flex flex-wrap gap-3">
                        <div><input type="checkbox" id="topping-ricecake" class="hidden topping-checkbox" data-topping="ricecake"><label id="label-ricecake" for="topping-ricecake" class="cursor-pointer block text-center py-2 px-4 rounded-full border-2 border-zinc-600 transition-all">ë–¡êµ­ë–¡ ğŸš</label></div>
                        <div><input type="checkbox" id="topping-scallion" class="hidden topping-checkbox" data-topping="scallion"><label id="label-scallion" for="topping-scallion" class="cursor-pointer block text-center py-2 px-4 rounded-full border-2 border-zinc-600 transition-all">íŒŒ ğŸŒ¿</label></div>
                        <div><input type="checkbox" id="topping-cheese" class="hidden topping-checkbox" data-topping="cheese"><label id="label-cheese" for="topping-cheese" class="cursor-pointer block text-center py-2 px-4 rounded-full border-2 border-zinc-600 transition-all">ì¹˜ì¦ˆ ğŸ§€</label></div>
                        <div><input type="checkbox" id="topping-egg" class="hidden topping-checkbox" data-topping="egg"><label id="label-egg" for="topping-egg" class="cursor-pointer block text-center py-2 px-4 rounded-full border-2 border-zinc-600 transition-all">ê³„ë€ ğŸ¥š</label></div>
                    </div>
                    <div id="egg-options" class="mt-4 p-4 bg-zinc-700/50 rounded-lg hidden">
                        <p id="egg-doneness-title" class="font-semibold mb-2">ê³„ë€ ìµí˜ ì •ë„:</p>
                        <div class="flex gap-3">
                            <div><input type="radio" id="egg-soft" name="egg-type" value="soft" class="hidden egg-radio" checked><label id="label-soft-egg" for="egg-soft" class="cursor-pointer block text-center py-2 px-4 rounded-full border-2 border-zinc-500 transition-all">ë°˜ìˆ™</label></div>
                            <div><input type="radio" id="egg-hard" name="egg-type" value="hard" class="hidden egg-radio"><label id="label-hard-egg" for="egg-hard" class="cursor-pointer block text-center py-2 px-4 rounded-full border-2 border-zinc-500 transition-all">ì™„ìˆ™</label></div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Right Column: Timer & Status -->
            <div class="lg:w-1/2 mt-8 lg:mt-0">
                <div class="lg:sticky lg:top-8">
                     <section id="cooking-guide-section" class="bg-zinc-800 p-6 rounded-2xl shadow-lg text-center hidden">
                        <h2 id="recipe-title" class="text-2xl font-bold mb-2 text-amber-400"></h2>
                        <div id="timer-display" class="timer-display font-mono font-bold my-4 text-zinc-100"></div>
                        <div class="bg-zinc-900 p-4 rounded-lg min-h-[80px] flex items-center justify-center">
                            <p id="current-instruction" class="text-xl text-amber-300 font-semibold"></p>
                        </div>
                        
                        <div class="flex justify-center gap-4 mt-6">
                            <button id="action-btn" class="bg-amber-500 hover:bg-amber-600 text-zinc-900 font-bold py-3 px-8 rounded-full text-xl transition-all transform hover:scale-105 w-40">ì‹œì‘</button>
                            <button id="next-btn" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-8 rounded-full text-xl transition-all transform w-40">ë‹¤ìŒ ë‹¨ê³„</button>
                            <button id="reset-btn" class="bg-zinc-600 hover:bg-zinc-700 text-white font-bold py-3 px-8 rounded-full text-xl transition-all transform hover:scale-105">ì´ˆê¸°í™”</button>
                        </div>
                    </section>
                </div>
            </div>
        </main>

        <footer class="text-center mt-10 pb-6">
            <p class="text-sm text-zinc-500">Developed by ê°€ì¹˜ìˆëŠ”ë¯¸ë˜êµìœ¡ì—°êµ¬ì†Œ ëŒ€í‘œ ê¹€ë³‘ì°¬</p>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.min.js"></script>
    <script>
    const translations = {
        ko: {
            // UI
            "app-title": "ğŸœ ë¼ë©´ íƒ€ì´ë¨¸", "app-subtitle": "ë‹¨ê³„ë³„ë¡œ ë”°ë¼í•˜ëŠ” ì™„ë²½í•œ ë¼ë©´ ì¡°ë¦¬ë²•",
            "ramen-select-title": "1. ì¡°ë¦¬í•  ë¼ë©´ì„ ì„ íƒí•˜ì„¸ìš”", "topping-select-title": "2. ì¶”ê°€í•  í† í•‘ì„ ì„ íƒí•˜ì„¸ìš”",
            "label-ricecake": "ë–¡êµ­ë–¡ ğŸš", "label-scallion": "íŒŒ ğŸŒ¿", "label-cheese": "ì¹˜ì¦ˆ ğŸ§€", "label-egg": "ê³„ë€ ğŸ¥š",
            "egg-doneness-title": "ê³„ë€ ìµí˜ ì •ë„:", "label-soft-egg": "ë°˜ìˆ™", "label-hard-egg": "ì™„ìˆ™",
            "action-btn-start": "ì‹œì‘", "action-btn-cooking": "ì¡°ë¦¬ ì¤‘...", "next-btn": "ë‹¤ìŒ ë‹¨ê³„", "reset-btn": "ì´ˆê¸°í™”",
            "button-complete": "ì™„ë£Œ",
            
            // Ramen Names
            shin: 'ì‹ ë¼ë©´', neoguri: 'ë„ˆêµ¬ë¦¬', ansung: 'ì•ˆì„±íƒ•ë©´', jin: 'ì§„ë¼ë©´', samyang: 'ì‚¼ì–‘ë¼ë©´',
            jjapagetti: 'ì§œíŒŒê²Œí‹°', buldak: 'ë¶ˆë‹­ë³¶ìŒë©´', bibim: 'ë¹„ë¹”ë©´', wang: 'ì™•ëšœê»‘',
            
            // Recipes
            cook_boil_water: (water) => `ë¬¼ ${water}mlë¥¼ ë“ì—¬ì£¼ì„¸ìš”.`,
            cook_add_noodles_soup: 'ë©´ê³¼ ìŠ¤í”„ë¥¼ ë„£ê³  ë“ì—¬ì£¼ì„¸ìš”.',
            cook_add_noodles_flakes: 'ë©´ê³¼ í›„ë ˆì´í¬ë¥¼ ë„£ê³  ë“ì—¬ì£¼ì„¸ìš”.',
            cook_add_noodles: 'ë©´ì„ ë„£ê³  ë“ì—¬ì£¼ì„¸ìš”.',
            cook_drain_water: 'ë¬¼ 8ìŠ¤í‘¼ì„ ë‚¨ê¸°ê³  ë²„ë¦° í›„, ìŠ¤í”„ë¥¼ ë„£ì–´ì£¼ì„¸ìš”.',
            cook_drain_water_some: 'ë¬¼ì„ ì•½ê°„ ë‚¨ê¸°ê³  ë²„ë¦° í›„, ì†ŒìŠ¤ë¥¼ ë„£ì–´ì£¼ì„¸ìš”.',
            cook_stir_fry: 'ì•½í•œ ë¶ˆì—ì„œ ë¹„ë²¼ì£¼ë©° ë³¶ì•„ì£¼ì„¸ìš”.',
            cook_rinse_noodles: 'ì°¬ë¬¼ì— ë©´ì„ í—¹êµ¬ê³  ë¬¼ê¸°ë¥¼ ë¹¼ì£¼ì„¸ìš”.',
            cook_mix_sauce: 'ì†ŒìŠ¤ì™€ ë¹„ë²¼ ë§›ìˆê²Œ ë“œì„¸ìš”!',
            cook_pour_hot_water: (water) => `${water}ê¹Œì§€ ëœ¨ê±°ìš´ ë¬¼ì„ ë¶€ì–´ì£¼ì„¸ìš”.`,
            cook_wait_3_min: '3ë¶„ê°„ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.',
            
            // Toppings & Finish
            topping_add_ricecake: 'ë–¡ì„ ì§€ê¸ˆ ë„£ì–´ì£¼ì„¸ìš”! ğŸš',
            topping_add_egg: (type) => `ê³„ë€(${type})ì„ ë„£ì–´ì£¼ì„¸ìš”! ğŸ¥š`,
            topping_egg_hard: 'ì™„ìˆ™', topping_egg_soft: 'ë°˜ìˆ™',
            topping_add_scallion: 'íŒŒë¥¼ ì§€ê¸ˆ ë„£ì–´ì£¼ì„¸ìš”! ğŸŒ¿',
            finish_add_cheese: 'ë¶ˆì„ ë„ê³  ì¹˜ì¦ˆë¥¼ ì˜¬ë ¤ì£¼ì„¸ìš”! ğŸ§€',
            finish_enjoy: 'ì™„ì„±! ë§›ìˆê²Œ ë“œì„¸ìš”! ğŸ˜‹'
        },
        en: {
            "app-title": "ğŸœ Ramen Timer", "app-subtitle": "The perfect step-by-step ramen guide",
            "ramen-select-title": "1. Select your ramen", "topping-select-title": "2. Choose your toppings",
            "label-ricecake": "Rice Cake ğŸš", "label-scallion": "Scallion ğŸŒ¿", "label-cheese": "Cheese ğŸ§€", "label-egg": "Egg ğŸ¥š",
            "egg-doneness-title": "Egg doneness:", "label-soft-egg": "Soft-boiled", "label-hard-egg": "Hard-boiled",
            "action-btn-start": "Start", "action-btn-cooking": "Cooking...", "next-btn": "Next Step", "reset-btn": "Reset",
            "button-complete": "Complete",
            
            shin: 'Shin Ramyun', neoguri: 'Neoguri', ansung: 'Ansungtangmyun', jin: 'Jin Ramen', samyang: 'Samyang Ramen',
            jjapagetti: 'Jjapagetti', buldak: 'Buldak Ramen', bibim: 'Bibim Men', wang: 'Wang Ttukkeong',
            
            cook_boil_water: (water) => `Boil ${water}ml of water.`,
            cook_add_noodles_soup: 'Add noodles and soup base, then boil.',
            cook_add_noodles_flakes: 'Add noodles and flakes, then boil.',
            cook_add_noodles: 'Add noodles and boil.',
            cook_drain_water: 'Leave 8 spoons of water, drain the rest, and add powder soup.',
            cook_drain_water_some: 'Leave a little water, drain the rest, and add sauce.',
            cook_stir_fry: 'Stir-fry on low heat.',
            cook_rinse_noodles: 'Rinse noodles in cold water and drain.',
            cook_mix_sauce: 'Mix with sauce and enjoy!',
            cook_pour_hot_water: (water) => `Pour hot water up to the ${water}.`,
            cook_wait_3_min: 'Wait for 3 minutes.',
            
            topping_add_ricecake: 'Add rice cakes now! ğŸš',
            topping_add_egg: (type) => `Add ${type} egg now! ğŸ¥š`,
            topping_egg_hard: 'hard-boiled', topping_egg_soft: 'soft-boiled',
            topping_add_scallion: 'Add scallions now! ğŸŒ¿',
            finish_add_cheese: 'Turn off heat and add cheese! ğŸ§€',
            finish_enjoy: 'Done! Enjoy your meal! ğŸ˜‹'
        },
        ja: {
            "app-title": "ğŸœ ãƒ©ãƒ¼ãƒ¡ãƒ³ã‚¿ã‚¤ãƒãƒ¼", "app-subtitle": "ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã§å®Œç’§ãªãƒ©ãƒ¼ãƒ¡ãƒ³ä½œã‚Š",
            "ramen-select-title": "1. ãƒ©ãƒ¼ãƒ¡ãƒ³ã‚’é¸ã‚“ã§ãã ã•ã„", "topping-select-title": "2. ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚’é¸ã‚“ã§ãã ã•ã„",
            "label-ricecake": "ãƒˆãƒƒã‚¯ ğŸš", "label-scallion": "ãƒã‚® ğŸŒ¿", "label-cheese": "ãƒãƒ¼ã‚º ğŸ§€", "label-egg": "åµ ğŸ¥š",
            "egg-doneness-title": "åµã®å›ºã•:", "label-soft-egg": "åŠç†Ÿ", "label-hard-egg": "å›ºã‚†ã§",
            "action-btn-start": "ã‚¹ã‚¿ãƒ¼ãƒˆ", "action-btn-cooking": "èª¿ç†ä¸­...", "next-btn": "æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—", "reset-btn": "ãƒªã‚»ãƒƒãƒˆ",
            "button-complete": "å®Œäº†",

            shin: 'è¾›ãƒ©ãƒ¼ãƒ¡ãƒ³', neoguri: 'ãƒã‚°ãƒª', ansung: 'å®‰åŸæ¹¯éºº', jin: 'ã‚¸ãƒ³ãƒ©ãƒ¼ãƒ¡ãƒ³', samyang: 'ä¸‰é¤Šãƒ©ãƒ¼ãƒ¡ãƒ³',
            jjapagetti: 'ãƒãƒ£ãƒ‘ã‚²ãƒ†ã‚£', buldak: 'ãƒ–ãƒ«ãƒ€ãƒƒã‚¯ç‚’ã‚éºº', bibim: 'ãƒ“ãƒ“ãƒ³éºº', wang: 'ç‹æ§˜ã®ãƒ•ã‚¿',
            
            cook_boil_water: (water) => `æ°´${water}mlã‚’æ²¸ã‹ã—ã¦ãã ã•ã„ã€‚`,
            cook_add_noodles_soup: 'éººã¨ã‚¹ãƒ¼ãƒ—ã‚’å…¥ã‚Œã¦ç…®è¾¼ã¿ã¾ã™ã€‚',
            cook_add_noodles_flakes: 'éººã¨ãƒ•ãƒ¬ãƒ¼ã‚¯ã‚’å…¥ã‚Œã¦ç…®è¾¼ã¿ã¾ã™ã€‚',
            cook_add_noodles: 'éººã‚’å…¥ã‚Œã¦ç…®è¾¼ã¿ã¾ã™ã€‚',
            cook_drain_water: 'ãŠæ¹¯ã‚’å¤§ã•ã˜8æ¯æ®‹ã—ã¦æ¨ã¦ã€ç²‰æœ«ã‚¹ãƒ¼ãƒ—ã‚’å…¥ã‚Œã¾ã™ã€‚',
            cook_drain_water_some: 'ãŠæ¹¯ã‚’å°‘ã—æ®‹ã—ã¦æ¨ã¦ã€ã‚½ãƒ¼ã‚¹ã‚’å…¥ã‚Œã¾ã™ã€‚',
            cook_stir_fry: 'å¼±ç«ã§æ··ãœãªãŒã‚‰ç‚’ã‚ã¾ã™ã€‚',
            cook_rinse_noodles: 'éººã‚’å†·æ°´ã§ã™ã™ãã€æ°´æ°—ã‚’åˆ‡ã‚Šã¾ã™ã€‚',
            cook_mix_sauce: 'ã‚½ãƒ¼ã‚¹ã¨æ··ãœã¦ãŠå¬ã—ä¸ŠãŒã‚Šãã ã•ã„ï¼',
            cook_pour_hot_water: (water) => `${water}ã¾ã§ãŠæ¹¯ã‚’æ³¨ã„ã§ãã ã•ã„ã€‚`,
            cook_wait_3_min: '3åˆ†é–“å¾…ã¡ã¾ã™ã€‚',

            topping_add_ricecake: 'ä»Šã™ããƒˆãƒƒã‚¯ã‚’å…¥ã‚Œã¦ãã ã•ã„ï¼ ğŸš',
            topping_add_egg: (type) => `ä»Šã™ã${type}åµã‚’å…¥ã‚Œã¦ãã ã•ã„ï¼ ğŸ¥š`,
            topping_egg_hard: 'å›ºã‚†ã§', topping_egg_soft: 'åŠç†Ÿ',
            topping_add_scallion: 'ä»Šã™ããƒã‚®ã‚’å…¥ã‚Œã¦ãã ã•ã„ï¼ ğŸŒ¿',
            finish_add_cheese: 'ç«ã‚’æ­¢ã‚ã¦ãƒãƒ¼ã‚ºã‚’ã®ã›ã¦ãã ã•ã„ï¼ ğŸ§€',
            finish_enjoy: 'å®Œæˆï¼ç¾å‘³ã—ãå¬ã—ä¸ŠãŒã‚Œï¼ ğŸ˜‹'
        },
        zh: {
            "app-title": "ğŸœ æ‹‰é¢è®¡æ—¶å™¨", "app-subtitle": "åˆ†æ­¥å®Œç¾çš„æ‹‰é¢æŒ‡å—",
            "ramen-select-title": "1. é€‰æ‹©æ‚¨çš„æ‹‰é¢", "topping-select-title": "2. é€‰æ‹©æ‚¨çš„é…æ–™",
            "label-ricecake": "å¹´ç³• ğŸš", "label-scallion": "è‘± ğŸŒ¿", "label-cheese": "èŠå£« ğŸ§€", "label-egg": "é¸¡è›‹ ğŸ¥š",
            "egg-doneness-title": "é¸¡è›‹ç†Ÿåº¦:", "label-soft-egg": "æºå¿ƒ", "label-hard-egg": "å…¨ç†Ÿ",
            "action-btn-start": "å¼€å§‹", "action-btn-cooking": "çƒ¹é¥ªä¸­...", "next-btn": "ä¸‹ä¸€æ­¥", "reset-btn": "é‡ç½®",
            "button-complete": "å®Œæˆ",

            shin: 'è¾›æ‹‰é¢', neoguri: 'ä¹Œå†¬é¢', ansung: 'å®‰åŸæ±¤é¢', jin: 'çœŸæ‹‰é¢', samyang: 'ä¸‰å…»æ‹‰é¢',
            jjapagetti: 'ç‚¸é…±é¢', buldak: 'ç«é¸¡é¢', bibim: 'æ‹Œé¢', wang: 'ç‹ç›–æ‹‰é¢',

            cook_boil_water: (water) => `çƒ§å¼€${water}æ¯«å‡æ°´ã€‚`,
            cook_add_noodles_soup: 'åŠ å…¥é¢æ¡å’Œæ±¤æ–™ï¼Œç„¶åç…®æ²¸ã€‚',
            cook_add_noodles_flakes: 'åŠ å…¥é¢æ¡å’Œè”¬èœåŒ…ï¼Œç„¶åç…®æ²¸ã€‚',
            cook_add_noodles: 'åŠ å…¥é¢æ¡ç…®æ²¸ã€‚',
            cook_drain_water: 'ä¿ç•™8å‹ºæ°´ï¼Œå€’æ‰å…¶ä½™çš„æ°´ï¼Œç„¶ååŠ å…¥ç²‰çŠ¶æ±¤æ–™ã€‚',
            cook_drain_water_some: 'ä¿ç•™å°‘é‡æ°´ï¼Œå€’æ‰å…¶ä½™çš„æ°´ï¼Œç„¶ååŠ å…¥é…±æ±ã€‚',
            cook_stir_fry: 'ç”¨å°ç«ç¿»ç‚’ã€‚',
            cook_rinse_noodles: 'ç”¨å†·æ°´å†²æ´—é¢æ¡å¹¶æ²¥å¹²ã€‚',
            cook_mix_sauce: 'ä¸é…±æ±æ··åˆå³å¯äº«ç”¨ï¼',
            cook_pour_hot_water: (water) => `åŠ çƒ­æ°´è‡³${water}ã€‚`,
            cook_wait_3_min: 'ç­‰å¾…3åˆ†é’Ÿã€‚',

            topping_add_ricecake: 'ç°åœ¨åŠ å…¥å¹´ç³•ï¼ ğŸš',
            topping_add_egg: (type) => `ç°åœ¨åŠ å…¥${type}é¸¡è›‹ï¼ ğŸ¥š`,
            topping_egg_hard: 'å…¨ç†Ÿ', topping_egg_soft: 'æºå¿ƒ',
            topping_add_scallion: 'ç°åœ¨åŠ å…¥è‘±ï¼ ğŸŒ¿',
            finish_add_cheese: 'å…³ç«å¹¶åŠ å…¥èŠå£«ï¼ ğŸ§€',
            finish_enjoy: 'å®Œæˆï¼è¯·äº«ç”¨ï¼ ğŸ˜‹'
        },
        es: {
            "app-title": "ğŸœ Temporizador de Ramen", "app-subtitle": "La guÃ­a perfecta de ramen paso a paso",
            "ramen-select-title": "1. Selecciona tu ramen", "topping-select-title": "2. Elige tus toppings",
            "label-ricecake": "Pastel de arroz ğŸš", "label-scallion": "Cebolleta ğŸŒ¿", "label-cheese": "Queso ğŸ§€", "label-egg": "Huevo ğŸ¥š",
            "egg-doneness-title": "CocciÃ³n del huevo:", "label-soft-egg": "Pasado por agua", "label-hard-egg": "Huevo duro",
            "action-btn-start": "Empezar", "action-btn-cooking": "Cocinando...", "next-btn": "Siguiente", "reset-btn": "Reiniciar",
            "button-complete": "Completar",

            shin: 'Shin Ramyun', neoguri: 'Neoguri', ansung: 'Ansungtangmyun', jin: 'Jin Ramen', samyang: 'Samyang Ramen',
            jjapagetti: 'Jjapagetti', buldak: 'Buldak Ramen', bibim: 'Bibim Men', wang: 'Wang Ttukkeong',
            
            cook_boil_water: (water) => `Hervir ${water}ml de agua.`,
            cook_add_noodles_soup: 'AÃ±adir fideos y base de sopa, luego hervir.',
            cook_add_noodles_flakes: 'AÃ±adir fideos y copos, luego hervir.',
            cook_add_noodles: 'AÃ±adir fideos y hervir.',
            cook_drain_water: 'Dejar 8 cucharadas de agua, escurrir el resto y aÃ±adir la sopa en polvo.',
            cook_drain_water_some: 'Dejar un poco de agua, escurrir el resto y aÃ±adir la salsa.',
            cook_stir_fry: 'Saltear a fuego lento.',
            cook_rinse_noodles: 'Enjuagar los fideos en agua frÃ­a y escurrir.',
            cook_mix_sauce: 'Â¡Mezclar con la salsa y disfrutar!',
            cook_pour_hot_water: (water) => `Verter agua caliente hasta la ${water}.`,
            cook_wait_3_min: 'Esperar 3 minutos.',

            topping_add_ricecake: 'Â¡AÃ±ade los pasteles de arroz ahora! ğŸš',
            topping_add_egg: (type) => `Â¡AÃ±ade el huevo ${type} ahora! ğŸ¥š`,
            topping_egg_hard: 'duro', topping_egg_soft: 'pasado por agua',
            topping_add_scallion: 'Â¡AÃ±ade las cebolletas ahora! ğŸŒ¿',
            finish_add_cheese: 'Â¡Apaga el fuego y aÃ±ade el queso! ğŸ§€',
            finish_enjoy: 'Â¡Listo! Â¡Buen provecho! ğŸ˜‹'
        },
        de: {
            "app-title": "ğŸœ Ramen-Timer", "app-subtitle": "Die perfekte Schritt-fÃ¼r-Schritt-Anleitung fÃ¼r Ramen",
            "ramen-select-title": "1. WÃ¤hle dein Ramen", "topping-select-title": "2. WÃ¤hle deine Toppings",
            "label-ricecake": "Reiskuchen ğŸš", "label-scallion": "FrÃ¼hlingszwiebel ğŸŒ¿", "label-cheese": "KÃ¤se ğŸ§€", "label-egg": "Ei ğŸ¥š",
            "egg-doneness-title": "Ei-Garstufe:", "label-soft-egg": "Weich gekocht", "label-hard-egg": "Hart gekocht",
            "action-btn-start": "Start", "action-btn-cooking": "Kochen...", "next-btn": "NÃ¤chster Schritt", "reset-btn": "ZurÃ¼cksetzen",
            "button-complete": "AbschlieÃŸen",

            shin: 'Shin Ramyun', neoguri: 'Neoguri', ansung: 'Ansungtangmyun', jin: 'Jin Ramen', samyang: 'Samyang Ramen',
            jjapagetti: 'Jjapagetti', buldak: 'Buldak Ramen', bibim: 'Bibim Men', wang: 'Wang Ttukkeong',
            
            cook_boil_water: (water) => `${water}ml Wasser kochen.`,
            cook_add_noodles_soup: 'Nudeln und Suppenbasis hinzufÃ¼gen, dann kochen.',
            cook_add_noodles_flakes: 'Nudeln und Flocken hinzufÃ¼gen, dann kochen.',
            cook_add_noodles: 'Nudeln hinzufÃ¼gen und kochen.',
            cook_drain_water: '8 LÃ¶ffel Wasser Ã¼brig lassen, den Rest abgieÃŸen und die Pulversuppe hinzufÃ¼gen.',
            cook_drain_water_some: 'Ein wenig Wasser Ã¼brig lassen, den Rest abgieÃŸen und die SoÃŸe hinzufÃ¼gen.',
            cook_stir_fry: 'Bei schwacher Hitze unter RÃ¼hren braten.',
            cook_rinse_noodles: 'Nudeln in kaltem Wasser abspÃ¼len und abtropfen lassen.',
            cook_mix_sauce: 'Mit SoÃŸe mischen und genieÃŸen!',
            cook_pour_hot_water: (water) => `HeiÃŸes Wasser bis zur ${water} eingieÃŸen.`,
            cook_wait_3_min: '3 Minuten warten.',

            topping_add_ricecake: 'Jetzt Reiskuchen hinzufÃ¼gen! ğŸš',
            topping_add_egg: (type) => `Jetzt ${type} Ei hinzufÃ¼gen! ğŸ¥š`,
            topping_egg_hard: 'hart gekochtes', topping_egg_soft: 'weich gekochtes',
            topping_add_scallion: 'Jetzt FrÃ¼hlingszwiebeln hinzufÃ¼gen! ğŸŒ¿',
            finish_add_cheese: 'Hitze ausschalten und KÃ¤se hinzufÃ¼gen! ğŸ§€',
            finish_enjoy: 'Fertig! Guten Appetit! ğŸ˜‹'
        },
        vi: {
            "app-title": "ğŸœ Äá»“ng há»“ báº¥m giá» Ramen", "app-subtitle": "HÆ°á»›ng dáº«n náº¥u mÃ¬ ramen hoÃ n háº£o tá»«ng bÆ°á»›c",
            "ramen-select-title": "1. Chá»n loáº¡i mÃ¬ ramen cá»§a báº¡n", "topping-select-title": "2. Chá»n topping cá»§a báº¡n",
            "label-ricecake": "BÃ¡nh gáº¡o ğŸš", "label-scallion": "HÃ nh lÃ¡ ğŸŒ¿", "label-cheese": "PhÃ´ mai ğŸ§€", "label-egg": "Trá»©ng ğŸ¥š",
            "egg-doneness-title": "Äá»™ chÃ­n cá»§a trá»©ng:", "label-soft-egg": "LÃ²ng Ä‘Ã o", "label-hard-egg": "ChÃ­n ká»¹",
            "action-btn-start": "Báº¯t Ä‘áº§u", "action-btn-cooking": "Äang náº¥u...", "next-btn": "BÆ°á»›c tiáº¿p theo", "reset-btn": "Äáº·t láº¡i",
            "button-complete": "HoÃ n thÃ nh",

            shin: 'MÃ¬ Shin', neoguri: 'MÃ¬ Neoguri', ansung: 'MÃ¬ Ansungtangmyun', jin: 'MÃ¬ Jin', samyang: 'MÃ¬ Samyang',
            jjapagetti: 'MÃ¬ Jjapagetti', buldak: 'MÃ¬ cay Buldak', bibim: 'MÃ¬ trá»™n Bibim', wang: 'MÃ¬ Wang Ttukkeong',

            cook_boil_water: (water) => `Äun sÃ´i ${water}ml nÆ°á»›c.`,
            cook_add_noodles_soup: 'Cho mÃ¬ vÃ  gÃ³i sÃºp vÃ o, sau Ä‘Ã³ Ä‘un sÃ´i.',
            cook_add_noodles_flakes: 'Cho mÃ¬ vÃ  gÃ³i rau vÃ o, sau Ä‘Ã³ Ä‘un sÃ´i.',
            cook_add_noodles: 'Cho mÃ¬ vÃ o vÃ  Ä‘un sÃ´i.',
            cook_drain_water: 'Äá»ƒ láº¡i 8 muá»—ng nÆ°á»›c, Ä‘á»• pháº§n cÃ²n láº¡i vÃ  cho gÃ³i sÃºp bá»™t vÃ o.',
            cook_drain_water_some: 'Äá»ƒ láº¡i má»™t Ã­t nÆ°á»›c, Ä‘á»• pháº§n cÃ²n láº¡i vÃ  cho sá»‘t vÃ o.',
            cook_stir_fry: 'XÃ o trÃªn lá»­a nhá».',
            cook_rinse_noodles: 'Rá»­a mÃ¬ trong nÆ°á»›c láº¡nh vÃ  Ä‘á»ƒ rÃ¡o.',
            cook_mix_sauce: 'Trá»™n vá»›i sá»‘t vÃ  thÆ°á»Ÿng thá»©c!',
            cook_pour_hot_water: (water) => `Äá»• nÆ°á»›c nÃ³ng Ä‘áº¿n ${water}.`,
            cook_wait_3_min: 'Äá»£i trong 3 phÃºt.',

            topping_add_ricecake: 'BÃ¢y giá» cho bÃ¡nh gáº¡o vÃ o! ğŸš',
            topping_add_egg: (type) => `BÃ¢y giá» cho trá»©ng ${type} vÃ o! ğŸ¥š`,
            topping_egg_hard: 'chÃ­n ká»¹', topping_egg_soft: 'lÃ²ng Ä‘Ã o',
            topping_add_scallion: 'BÃ¢y giá» cho hÃ nh lÃ¡ vÃ o! ğŸŒ¿',
            finish_add_cheese: 'Táº¯t báº¿p vÃ  cho phÃ´ mai vÃ o! ğŸ§€',
            finish_enjoy: 'Xong! ChÃºc báº¡n ngon miá»‡ng! ğŸ˜‹'
        }
    };

    document.addEventListener('DOMContentLoaded', () => {
        // --- State Variables ---
        let selectedRamen = null;
        let timerInterval = null;
        let remainingTime = 0;
        let synth;
        let audioInitialized = false;
        let cookingSteps = [];
        let currentStepIndex = 0;
        let currentLang = 'ko';

        // --- UI Elements ---
        const langSelector = document.getElementById('language-selector');
        const ramenListEl = document.getElementById('ramen-list');
        const toppingSectionEl = document.getElementById('topping-selection');
        const cookingGuideSectionEl = document.getElementById('cooking-guide-section');
        const recipeTitleEl = document.getElementById('recipe-title');
        const timerDisplayEl = document.getElementById('timer-display');
        const currentInstructionEl = document.getElementById('current-instruction');
        const actionBtnEl = document.getElementById('action-btn');
        const nextBtnEl = document.getElementById('next-btn');
        const resetBtnEl = document.getElementById('reset-btn');
        const eggCheckbox = document.getElementById('topping-egg');
        const eggOptionsEl = document.getElementById('egg-options');

        const langVoiceMap = {
            ko: 'ko-KR', en: 'en-US', ja: 'ja-JP', zh: 'zh-CN',
            es: 'es-ES', de: 'de-DE', vi: 'vi-VN'
        };

        const ramenRecipes = {
            shin: { water: 550, img: 'ğŸœ', cookTime: 270 },
            neoguri: { water: 550, img: 'ğŸ²', cookTime: 300 },
            ansung: { water: 550, img: 'ğŸœ', cookTime: 270 },
            jin: { water: 550, img: 'ğŸ²', cookTime: 240 },
            samyang: { water: 550, img: 'ğŸœ', cookTime: 240 },
            jjapagetti: {
                water: 600, img: 'ğŸ', type: 'special', steps: [
                    { instruction: 'cook_boil_water', duration: 0, button: 'button-next' },
                    { instruction: 'cook_add_noodles_flakes', duration: 300 },
                    { instruction: 'cook_drain_water', duration: 0, button: 'button-next' },
                    { instruction: 'cook_stir_fry', duration: 60 },
                    { instruction: 'finish_enjoy', duration: 0, button: 'button-complete' }
                ]
            },
            buldak: {
                water: 600, img: 'ğŸŒ¶ï¸', type: 'special', steps: [
                    { instruction: 'cook_boil_water', duration: 0, button: 'button-next' },
                    { instruction: 'cook_add_noodles', duration: 300 },
                    { instruction: 'cook_drain_water_some', duration: 0, button: 'button-next' },
                    { instruction: 'cook_stir_fry', duration: 30 },
                    { instruction: 'finish_enjoy', duration: 0, button: 'button-complete' }
                ]
            },
            bibim: {
                water: 600, img: 'ğŸ¥—', type: 'special', steps: [
                    { instruction: 'cook_boil_water', duration: 0, button: 'button-next' },
                    { instruction: 'cook_add_noodles', duration: 180 },
                    { instruction: 'cook_rinse_noodles', duration: 0, button: 'button-next' },
                    { instruction: 'cook_mix_sauce', duration: 0, button: 'button-complete' }
                ]
            },
            wang: {
                water: 'line inside', img: 'ğŸ‘‘', type: 'special', steps: [
                    { instruction: 'cook_pour_hot_water', duration: 0, button: 'button-next' },
                    { instruction: 'cook_wait_3_min', duration: 180 },
                    { instruction: 'finish_enjoy', duration: 0, button: 'button-complete' }
                ]
            }
        };

        // --- Audio ---
        async function initializeAudio() {
            if (audioInitialized || typeof Tone === 'undefined') return;
            try {
                await Tone.start();
                synth = new Tone.Synth().toDestination();
                audioInitialized = true;
            } catch (e) { console.error("Could not initialize audio:", e); }
        }

        function removeEmojis(text) {
            if (!text) return '';
            // This regex covers a wide range of emojis
            return text.replace(/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g, '').trim();
        }

        function speak(text) {
            if (!'speechSynthesis' in window) return;
            const textWithoutEmojis = removeEmojis(text);
            speechSynthesis.cancel(); // Stop any previous speech
            const utterance = new SpeechSynthesisUtterance(textWithoutEmojis);
            utterance.lang = langVoiceMap[currentLang];
            speechSynthesis.speak(utterance);
        }

        // --- Language & Translation ---
        function setLanguage(lang) {
            currentLang = lang;
            document.documentElement.lang = lang;
            const langTrans = translations[lang];

            document.getElementById('app-title').textContent = langTrans['app-title'];
            document.getElementById('app-subtitle').textContent = langTrans['app-subtitle'];
            document.getElementById('ramen-select-title').textContent = langTrans['ramen-select-title'];
            document.getElementById('topping-select-title').textContent = langTrans['topping-select-title'];
            document.getElementById('label-ricecake').textContent = langTrans['label-ricecake'];
            document.getElementById('label-scallion').textContent = langTrans['label-scallion'];
            document.getElementById('label-cheese').textContent = langTrans['label-cheese'];
            document.getElementById('label-egg').textContent = langTrans['label-egg'];
            document.getElementById('egg-doneness-title').textContent = langTrans['egg-doneness-title'];
            document.getElementById('label-soft-egg').textContent = langTrans['label-soft-egg'];
            document.getElementById('label-hard-egg').textContent = langTrans['label-hard-egg'];
            document.getElementById('reset-btn').textContent = langTrans['reset-btn'];

            renderRamenCards();
            if (selectedRamen) {
                recipeTitleEl.textContent = langTrans[selectedRamen];
                generateSteps();
                resetState();
            } else {
                renderCurrentStep();
            }
        }
        
        // --- UI Rendering ---
        function renderRamenCards() {
            ramenListEl.innerHTML = '';
            const langTrans = translations[currentLang];
            Object.keys(ramenRecipes).forEach(id => {
                const recipe = ramenRecipes[id];
                const card = document.createElement('div');
                card.className = 'ramen-card cursor-pointer bg-zinc-700 p-4 rounded-lg text-center';
                card.dataset.ramenId = id;
                card.innerHTML = `<div class="text-4xl mb-2">${recipe.img}</div><span class="font-semibold">${langTrans[id]}</span>`;
                card.addEventListener('click', () => selectRamen(id));
                if (id === selectedRamen) card.classList.add('selected');
                ramenListEl.appendChild(card);
            });
        }

        function renderCurrentStep() {
            nextBtnEl.classList.remove('pulse-attention');
            const langTrans = translations[currentLang];

            if (!selectedRamen) {
                currentInstructionEl.textContent = '';
                timerDisplayEl.textContent = '';
                actionBtnEl.style.display = 'none';
                nextBtnEl.style.display = 'none';
                return;
            }

            const step = cookingSteps[currentStepIndex];

            if (!step) {
                actionBtnEl.style.display = 'none';
                nextBtnEl.style.display = 'inline-block';
                nextBtnEl.disabled = true;
                nextBtnEl.textContent = langTrans['button-complete'];
                return;
            }
            
            const instructionTemplate = langTrans[step.instruction];
            let waterAmount = ramenRecipes[selectedRamen].water;
            if (currentLang !== 'ko' && waterAmount === 'ìš©ê¸° ì•ˆìª½ ì„ ') waterAmount = 'line inside';

            let instructionText = typeof instructionTemplate === 'function' ? instructionTemplate(waterAmount) : instructionTemplate;
            
            currentInstructionEl.textContent = instructionText;
            speak(instructionText);

            nextBtnEl.style.display = 'inline-block'; // Always show next button during steps
            nextBtnEl.disabled = false;

            if (step.duration > 0) {
                remainingTime = step.duration;
                timerDisplayEl.textContent = formatTime(remainingTime);
                actionBtnEl.textContent = langTrans['action-btn-start'];
                actionBtnEl.disabled = false;
                actionBtnEl.style.display = 'inline-block';
                nextBtnEl.textContent = langTrans['next-btn'];
            } else {
                timerDisplayEl.textContent = '';
                actionBtnEl.style.display = 'none';
                if (step.button === 'button-complete') {
                    nextBtnEl.textContent = langTrans['button-complete'];
                } else {
                    nextBtnEl.textContent = langTrans['next-btn'];
                }
                setTimeout(() => nextBtnEl.classList.add('pulse-attention'), 100);
            }
        }

        // --- Event Handlers ---
        langSelector.addEventListener('change', (e) => setLanguage(e.target.value));

        function selectRamen(id) {
            selectedRamen = id;
            renderRamenCards();
            
            recipeTitleEl.textContent = translations[currentLang][id];
            generateSteps();
            resetState();

            toppingSectionEl.classList.remove('hidden');
            cookingGuideSectionEl.classList.remove('hidden');

            if (window.innerWidth < 1024) { // lg breakpoint
                cookingGuideSectionEl.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        actionBtnEl.addEventListener('click', () => {
            initializeAudio();
            const step = cookingSteps[currentStepIndex];
            if (step && step.duration > 0 && !timerInterval) {
                startTimer();
            }
        });

        nextBtnEl.addEventListener('click', () => {
            const step = cookingSteps[currentStepIndex];
            if(!step || step.button === 'button-complete') return;
            
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            proceedToNextStep();
        });

        resetBtnEl.addEventListener('click', () => {
            if (selectedRamen) {
                generateSteps();
                resetState();
            }
        });

        document.querySelectorAll('#topping-selection input').forEach(input => {
            input.addEventListener('change', () => {
                if (selectedRamen) {
                    generateSteps();
                    resetState();
                }
            });
        });
        
        eggCheckbox.addEventListener('change', (e) => {
            eggOptionsEl.classList.toggle('hidden', !e.target.checked);
        });

        // --- Logic ---
        function generateSteps() {
            const recipe = ramenRecipes[selectedRamen];
            const toppings = getSelectedToppings();

            if (recipe.type === 'special') {
                cookingSteps = [...recipe.steps]; // Create a copy
                return;
            }
            
            let steps = [
                { instruction: 'cook_boil_water', duration: 0, button: 'button-next' },
                { instruction: 'cook_add_noodles_soup', duration: recipe.cookTime, isCookingStep: true }
            ];

            let finalInstruction = toppings.cheese ? 'finish_add_cheese' : 'finish_enjoy';
            steps.push({ instruction: finalInstruction, duration: 0, button: 'button-complete' });
            
            let cookingStep = steps.find(s => s.isCookingStep);
            if (cookingStep) {
                cookingStep.subSteps = [];
                const langTrans = translations[currentLang];
                if(toppings.ricecake) cookingStep.subSteps.push({ time: cookingStep.duration - 10, instruction: langTrans.topping_add_ricecake });
                if(toppings.egg) {
                    const eggTime = toppings.eggType === 'hard' ? 210 : 90;
                    if(cookingStep.duration >= eggTime) {
                        const eggTypeText = langTrans[`topping_egg_${toppings.eggType}`];
                        cookingStep.subSteps.push({ time: eggTime, instruction: langTrans.topping_add_egg(eggTypeText) });
                    }
                }
                if(toppings.scallion) cookingStep.subSteps.push({ time: 30, instruction: langTrans.topping_add_scallion });
                cookingStep.subSteps.sort((a,b) => b.time - a.time);
            }

            cookingSteps = steps;
        }

        function proceedToNextStep() {
            playNotificationSound();
            currentStepIndex++;
            renderCurrentStep();
        }

        function startTimer() {
            const subSteps = [...(cookingSteps[currentStepIndex]?.subSteps || [])];
            const langTrans = translations[currentLang];

            actionBtnEl.textContent = langTrans['action-btn-cooking'];
            actionBtnEl.disabled = true;

            timerInterval = setInterval(() => {
                remainingTime--;
                timerDisplayEl.textContent = formatTime(remainingTime);

                if (subSteps.length > 0 && remainingTime === subSteps[0].time) {
                    const subInstruction = subSteps[0].instruction;
                    currentInstructionEl.textContent = subInstruction;
                    speak(subInstruction);
                    playNotificationSound();
                    subSteps.shift();
                }

                if (remainingTime <= 0) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                    actionBtnEl.style.display = 'none';
                    
                    const nextStep = cookingSteps[currentStepIndex + 1];
                    if (nextStep) {
                        const nextStepKey = nextStep.instruction;
                        const nextStepTemplate = translations[currentLang][nextStepKey];
                        const nextStepText = typeof nextStepTemplate === 'function' ? nextStepTemplate(ramenRecipes[selectedRamen].water) : nextStepTemplate;
                        speak(nextStepText);
                        setTimeout(() => nextBtnEl.classList.add('pulse-attention'), 100);
                    }
                }
            }, 1000);
        }

        function resetState() {
            clearInterval(timerInterval);
            timerInterval = null;
            speechSynthesis.cancel();
            currentStepIndex = 0;
            renderCurrentStep();
        }
        
        function getSelectedToppings() {
            return {
                ricecake: document.getElementById('topping-ricecake').checked,
                scallion: document.getElementById('topping-scallion').checked,
                cheese: document.getElementById('topping-cheese').checked,
                egg: document.getElementById('topping-egg').checked,
                eggType: document.querySelector('input[name="egg-type"]:checked').value
            };
        }

        // --- Utility ---
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        function playNotificationSound() {
            if (audioInitialized && synth) {
                synth.triggerAttackRelease("C5", "8n", Tone.now());
            }
        }

        // --- Initial Load ---
        setLanguage('ko');
    });
    </script>
</body>
</html>

